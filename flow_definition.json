{ "description": "Logic for Bid Intake Automation", "triggers": { "When_Email_Arrives": { "type": "OpenApiConnection", "inputs": { "host": { "connectionName": "shared_office365" }, "method": "get", "path": "/v3/Mail/OnNewEmail", "queries": { "folderPath": "Inbox", "hasAttachments": true } } } }, "actions": { "Check_Duplicates": { "type": "OpenApiConnection", "inputs": { "host": { "connectionName": "shared_sharepointonline" }, "method": "get", "path": "/datasets/@{encodeURIComponent(encodeURIComponent(variables('SiteURL')))}/tables/@{encodeURIComponent(encodeURIComponent('BidInvitesLog'))}/items", "queries": { "$filter": "MessageID eq '@{triggerOutputs()?['body/id']}'" } } }, "Create_Folder_Structure": { "type": "Http", "inputs": { "method": "POST", "uri": "https://graph.microsoft.com/v1.0/sites/{site-id}/drive/items/{parent-id}/children", "body": { "name": "@{triggerOutputs()?['body/subject']}", "folder": { }, "@microsoft.graph.conflictBehavior": "rename" } } }, "Post_Teams_Notification": { "type": "OpenApiConnection", "inputs": { "host": { "connectionName": "shared_teams" }, "method": "post", "path": "/v2/teams/conversation/message", "body": { "recipient": "ConstructionChannelID", "message": "üèóÔ∏è New Bid Invitation Received: @{triggerOutputs()?['body/subject']}" } } } } }